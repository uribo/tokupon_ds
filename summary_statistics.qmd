---
title: "データの特徴を捉える"
---

```{r}
#| include: false
library(dplyr)
library(ragg)
```


```{r}
df_zoo <- 
  readr::read_csv("data-raw/tokushima_zoo_animals22.csv", 
                col_types = "ccdd_")
```


## データをグラフに表現する


数学は統計学的な考え方において必須ではありません。

探索的データ分析

度数分布表、ヒストグラム、箱ヒゲ図、散布図、カルトグラム

[データ分析の目的](intro.qmd#)の一つに「データを要約すること」があることを示しました。
それでは実際に、データの要約に取り組んでみましょう。
例として動物データの体長を表示します。

```{r}
#| code-fold: false
df_zoo$body_length_cm
```

このデータの特徴として言えることは何でしょうか？
動物データに含まれるわずか`r nrow(df_zoo)`件の数値でも、こうした数値の羅列からデータの特徴を説明することは困難です。
データ分析で扱うデータの件数は数千、数万となる場合もあり、一つ一つデータを見ていくことも
現実的ではありません。
そこでデータを要約するために**代表値**の計算や**データの可視化**が行われます。

### 代表値

まず、複数の数値の性質や特徴をよく表す代表値について説明します。
代表値によるデータの要約は、データに含まれる数値の傾向を大まかに把握するために便利です。
代表値という名前の通り、数値によるデータの表現方法となります。

代表値によるデータを要約する方法にはさまざまなものがあります。代表的なものは**平均値**の計算です。

平均値にも複数の種類が存在しますが、ここではより一般的な算術平均を平均値の例として扱います。


最小値、最大値

### データの分布

データの分布を明らかにする。

ある値がデータに含まれる数を<ruby>度数<rt>どすう</rt></ruby>または<ruby>頻度<rt>ひんど</rt></ruby>といいます。
動物のデータセットの分類群に対して度数を求めると次のようになります。

```{r}
#| echo: true
# 度数、頻度を英語で frequency といいます
count(df_zoo, taxon, name = "frequency") |>
  knitr::kable()
```

対象が量的変数の場合は頻度を簡単に求めることができます。
それでは量的変数、特に連続変数に対し度数を求めるにはどうすれば良いでしょうか。
量的変数に対して連続変数では同じ値をとることが少ないです。
そのため連続変数の度数を求めるときは、変数がとり得る値をいくつかの階級に分けて考えます。

階級分けのために、まずは変数の最小値と最大値を調べましょう。
最小値と最大値はそれぞれ`min()`関数と`max()`関数に対象の変数を与えることで求められます。

```{r}
#| echo: true
#| code-fold: false
# 動物データの体長について最小値・最大値を求める
min(df_zoo$body_length_cm, na.rm = TRUE)
max(df_zoo$body_length_cm, na.rm = TRUE)
```

最小値・最大値を一度に求めるための`range()`関数も同様に扱えます。

```{r}
#| echo: true
#| code-fold: false
range(df_zoo$body_length_cm, na.rm = TRUE)
```

最小値と最大値がわかったところで、次は階級を設定します。




データ中の度数をまとめて表形式にしたものは度数分布表と呼ばれます。

分類群の値ごとに同じデータがどれだけあるかをカウントして度数を求めます。


**度数分布表**は手元のデータの値をいくつかの階級 (class)

### データのばらつき

分散、標準偏差

### ヒストグラム

代表値に対して、データを図で表現する方法を解説します。
ヒストグラム、箱ヒゲ図、散布図は数値を図で表すための方法として用いられます。

度数分布をグラフ化する方法の一つとして**ヒストグラム**があります。

```{r}
#| label: 動物の体長のヒストグラム
#| warning: false
library(ggplot2)

df_zoo |> 
  ggplot(aes(body_length_cm)) +
  geom_histogram(bins = 6)
```

<!-- ビンの数を変えるとヒストグラムの形も変わる -->

::: {.callout-warning}

#### 階級幅の異なるヒストグラム

階級の幅が一定でないヒストグラムが存在するよ。

:::


データに対する説得力を増すためにも使われます。

データの特徴を素早く捉えることができます。

### 箱ひげ図


## 代表値

- 中央値

```{r}
sort(df_zoo$body_length_cm)
median(df_zoo$body_length_cm, na.rm = TRUE)

(sort(df_zoo$body_length_cm)[9] + sort(df_zoo$body_length_cm)[10]) / 2
```

## データのばらつき

パーセンタイル

箱ヒゲ図

## 相関: 2つの変数の間の関係

相関係数

相関係数は変数間の因果関係を示すものではありません。
例えば、ある地域の８月において、毎日のアイスの売り上げ個数と熱中症患者数の間に
正の相関があった場合でも、アイスが熱中症の原因となっているわけではありません。
アイスの売り上げ、熱中症の双方に影響するもの、気温が原因です。
気温について考慮せずに分析を進めてしまうと、見せかけの因果関係を発生させてしまいます。
熱中症患者の増加を抑えるためにアイスの販売を規制するなどの誤った対策が取られてしまう
恐れがあります。

